{% extends 'base.html' %}
{% block content %}
<section>
  <h1 class="page-title">Track your rowing, see your progress</h1>
  <div class="tabs" role="tablist" aria-label="Rowing views">
    <button class="tab active" role="tab" aria-selected="true" aria-controls="panel-log" id="tab-log" data-target="#panel-log">Log Session</button>
    <button class="tab" role="tab" aria-selected="false" aria-controls="panel-charts" id="tab-charts" data-target="#panel-charts">Charts</button>
  </div>

  <section id="panel-log" class="tab-panel" role="tabpanel" aria-labelledby="tab-log">
    <form class="card form" action="{{ url_for('log') }}" method="POST">
      <div class="grid">
        <div class="field">
          <label for="date">Date</label>
          <input type="date" id="date" name="date" value="" required />
        </div>
        <div class="field">
          <label for="distance_km">Distance (km)</label>
          <input type="number" step="0.01" min="0" id="distance_km" name="distance_km" placeholder="e.g. 12.5" required />
        </div>
        <div class="field">
          <label for="duration_min">Duration (min)</label>
          <input type="number" step="1" min="0" id="duration_min" name="duration_min" placeholder="e.g. 60" />
        </div>
        <div class="field">
          <label for="split">Split (min:sec/500m)</label>
          <input type="text" pattern="^[0-9]{1,2}:[0-5]?[0-9](\.[0-9]+)?$" id="split" name="split" placeholder="e.g. 2:05 or 1:58.5" />
        </div>
        <div class="field">
          <label for="session_type">Session type</label>
          <select id="session_type" name="session_type">
            {% for t in session_types %}
              <option value="{{ t }}">{{ t }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="field span-2">
          <label for="notes">Notes</label>
          <input type="text" id="notes" name="notes" placeholder="Intervals, splits, conditions..." />
        </div>
      </div>
      <div class="actions">
        <button class="btn-primary" type="submit">Save Session</button>
        <span class="hint">Tip: Enter any two of distance, duration, split to auto-fill the third.</span>
      </div>
    </form>
  </section>

  <section id="panel-charts" class="tab-panel hidden" role="tabpanel" aria-labelledby="tab-charts">
    <div class="card">
      <div class="toolbar">
        <label for="yearChartSelect">Year</label>
        <select id="yearChartSelect" aria-label="Select year for charts"></select>
      </div>
      <div class="charts-grid">
        <div class="chart-card">
          <h3>Daily mileage</h3>
          <canvas id="dailyLineChart" height="120"></canvas>
        </div>
        <div class="chart-card">
          <h3>Monthly totals by type</h3>
          <canvas id="monthlyTotalsChart" height="120"></canvas>
        </div>
        <div class="chart-card">
          <h3>Speed over time</h3>
          <canvas id="speedScatterChart" height="120"></canvas>
        </div>
        <div class="chart-card">
          <h3>Cumulative mileage</h3>
          <canvas id="cumulativeChart" height="120"></canvas>
        </div>
      </div>
    </div>
  </section>
</section>
{% endblock %}